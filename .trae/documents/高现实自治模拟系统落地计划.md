## æ€»ä½“æ¶æ„
- Agentè‡ªæ²»å¾ªç¯ï¼šæ„ŸçŸ¥â†’å†³ç­–â†’è¡ŒåŠ¨ï¼Œå«ç›®æ ‡ç®¡ç†ã€è¡Œä¸ºæ¨¡å¼ä¸å†³ç­–æ ‘ï¼ˆgenerative_agents/modules/decision/autonomous_decision.py:465-536, 697-745ï¼‰
- ä¸–ç•Œç¯å¢ƒï¼šæ— é™åˆ†å—åœ°å›¾ã€èµ„æºä¸åœ°å½¢å¼€å‘ã€å¤©æ°”ç³»ç»Ÿï¼ˆgenerative_agents/modules/infinite_maze.py; generative_agents/modules/terrain/terrain_development.py:201-213; generative_agents/modules/environment/environment_manager.pyï¼‰
- ç»æµä¸å»ºé€ ï¼šä»·æ ¼/äº¤æ˜“/åˆæˆä¸AIç»æµè¡Œä¸ºã€AIå»ºé€ å†³ç­–ï¼ˆgenerative_agents/modules/economy/economy.py; generative_agents/modules/decision/ai_economy_behavior.py; generative_agents/modules/decision/ai_building_decision.pyï¼‰
- ç¤¾äº¤ç½‘ç»œï¼šå…³ç³»ç±»å‹ä¸æ¼”åŒ–ã€äº’åŠ¨äº‹ä»¶ã€ç»Ÿè®¡ï¼ˆgenerative_agents/modules/social/relationship.pyï¼‰
- è°ƒåº¦ä¸»å¾ªç¯ï¼šç¯å¢ƒæ›´æ–°â†’AIç»æµ/å»ºé€ â†’Agentæ€è€ƒâ†’åœ°å›¾ç»´æŠ¤ï¼ˆgenerative_agents/modules/game.py:124-173, 177-199ï¼‰

## ç°æœ‰èƒ½åŠ›ä¸çŸ­æ¿
- å·²å…·å¤‡ï¼š
  - å†³ç­–æ ‘ä¸è¡Œä¸ºæ¨¡å¼ã€ç›®æ ‡ç®¡ç†ä¸ç»Ÿè®¡ï¼ˆautonomous_decision.py:537-592, 762-791ï¼‰
  - åœ°å½¢ç”Ÿæˆ/å»ºé€ /ç”Ÿäº§ä¸é¡¹ç›®æœºåˆ¶ï¼ˆterrain_development.py:214-275, 454-492, 619-642ï¼‰
  - ç»æµä»·å·®/äº¤æ˜“/åˆæˆä¸å¸‚åœºåŠ¨æ€ï¼ˆeconomy.py:149-174, 195-297, 298-341; ai_economy_behavior.py:428-457ï¼‰
  - æ— é™åœ°å›¾ä¸åˆ†å—ã€å¯»è·¯ä¸ç»Ÿè®¡ï¼ˆinfinite_maze.py:136-174, 419-482, 517-529ï¼‰
  - ç¤¾äº¤å…³ç³»æ¨¡å‹ä¸æ¼”åŒ–ã€è¡°é€€ä¸ç»Ÿè®¡ï¼ˆsocial/relationship.py:131-166, 338-348, 349-367ï¼‰
- çŸ­æ¿ï¼š
  - å»ºé€ ä¸åœ°å›¾æ˜¾ç¤ºæœªåŒæ­¥ï¼Œç”¨æˆ·éš¾ä»¥â€œçœ‹åˆ°â€è‡ªä¸»æ„å»ºä¸–ç•Œ
  - è°ƒè¯•ä¸è§‚æµ‹æ¥å£é›¶æ•£ï¼Œéœ€ç»Ÿä¸€APIæš´éœ²å†³ç­–/ç»æµ/ç¤¾äº¤/åœ°å›¾ç»Ÿè®¡
  - å¤§è§„æ¨¡å¹¶å‘ä¼˜åŒ–éœ€å®Œå–„ï¼šæ‰¹é‡tickã€äº‹ä»¶é™æµã€ç¼“å­˜

## ç›®æ ‡
- å®Œæ•´çš„è‡ªä¸»è¿è¡Œèƒ½åŠ›ï¼šæ— éœ€äººå·¥å¹²é¢„ï¼ŒæŒç»­äº§ç”Ÿåˆç†ä¸”æ–°é¢–è¡Œä¸º
- å¯è§†åŒ–å¯éªŒè¯ï¼šå‰ç«¯APIå¯è§‚å¯Ÿå»ºé€ /äº‹ä»¶/å†³ç­–ä¸èµ„æºå˜åŒ–
- æ‰©å±•æ€§ï¼šæ¨¡å—åŒ–æ¥å£ä¸é…ç½®ï¼Œä¾¿äºæ–°å¢è¡Œä¸ºç±»å‹
- æ€§èƒ½ä¸ç¨³å®šï¼šæ”¯æŒç™¾çº§Agentç¨³å®šè¿è¡Œï¼Œæ— æ­»é”æˆ–å¾ªç¯å¼‚å¸¸

## æŠ€æœ¯å®æ–½
### 1. å»ºé€ ç»“æœä¸åœ°å›¾å¯è§†å±‚åŒæ­¥
- åœ¨ game ä¸­å»ºç«‹ terrainâ†”worldåæ ‡æ˜ å°„æ–¹æ³•ï¼ŒæŒ‰1:1æˆ–ç»“åˆ`tile_size`ç¼©æ”¾
- åœ¨ `_process_agent_building_decision` æˆåŠŸå»ºé€ åï¼šå°†å»ºç­‘è½åœ°åˆ°åœ°å›¾ç“¦ç‰‡ï¼Œè®¾ç½®`tile.tile_type`ä¸ºç›¸åº”ç±»å‹å¹¶å†™å…¥äº‹ä»¶ï¼ˆğŸ , ğŸŒ¾, â›ï¸, ğŸ­, ğŸ›£ï¸ï¼‰ï¼›æ–½å·¥é˜¶æ®µç”¨ğŸš§ï¼Œå®Œå·¥æ›¿æ¢
- æ¯æ—¥è¿è¥ååˆ·æ–°æ–½å·¥è¿›åº¦å¯¹åº”å›¾æ ‡

### 2. å°±è¿‘é€‰å€ä¸â€œæ‰€è§å³æ‰€å¾—â€
- ä¸º `AIBuildingDecisionEngine.analyze_agent_building_intention` å¢åŠ å°±è¿‘åå¥½å‚æ•°ï¼Œç»“åˆ `find_optimal_development_sites` å¯¹å€™é€‰ç‚¹åŠ å…¥è·ç¦»åŠ æƒï¼Œä¼˜å…ˆè¿”å›Agenté™„è¿‘çš„é«˜åˆ†åœ°ç‚¹ï¼ˆai_building_decision.py:127-133ï¼‰

### 3. äº‹ä»¶ç”Ÿæˆæœºåˆ¶
- ç»Ÿä¸€äº‹ä»¶æ€»çº¿ï¼šåœ¨ game ç»´æŠ¤`recent_events`é˜Ÿåˆ—ï¼Œæ”¶é›†ç»æµäº¤æ˜“ã€å»ºé€ ã€ç¤¾äº¤äº’åŠ¨ã€å¤©æ°”å˜åŒ–ç­‰äº‹ä»¶æºï¼ˆeconomy.py:342-348ï¼›terrain_development.py:619-642ï¼›social/relationship.py:179-197ï¼‰
- æ‰©å±•ç¯å¢ƒäº‹ä»¶ï¼šå‘¨æœŸæ€§è§¦å‘å¤©æ°”å˜åŒ–ã€èŠ‚åº†ã€éšæœºé­é‡ï¼Œå½±å“Agentåˆ†æ”¯é€‰æ‹©ï¼ˆAgentçš„`_check_emergency/_check_basic_needs/_check_social_needs`å·²æœ‰é’©å­ï¼‰

### 4. ç¤¾äº¤å¤æ‚æ€§é›†æˆ
- åœ¨ game åˆå§‹åŒ–æ—¶ä¸º `SocialNetwork` æ³¨å†Œæ‰€æœ‰AgentåŸºæœ¬ä¿¡æ¯ï¼›æ¯tickæ¨¡æ‹Ÿå…³ç³»è¡°é€€ä¸æ½œåœ¨äº’åŠ¨åŒ¹é…
- å°†ç¤¾äº¤äº’åŠ¨äº‹ä»¶æ¥å…¥Agentå¯¹è¯ä¸å†³ç­–åˆ†æ”¯ï¼ˆautonomous_decision.py:510-533ï¼›agent.pyä¸­å¯¹è¯é€»è¾‘ï¼‰

### 5. æ¨¡å—åŒ–æ‰©å±•ç‚¹
- è¡Œä¸ºç±»å‹ï¼šåœ¨å†³ç­–æ ‘ä¸è¡Œä¸ºæ¨¡å¼ä¸­ä»¥èŠ‚ç‚¹/æ¨¡å¼æ’ä»¶å½¢å¼å¢åŠ æ–°è¡ŒåŠ¨
- èµ„æºä¸å»ºç­‘ï¼šåœ¨ `building_templates` ä¸ `CraftingRecipe` ä¸­æ‰©å±•ï¼ˆterrain_development.py:289-340ï¼›economy.py:85-114ï¼‰
- ç»æµç­–ç•¥ï¼šåœ¨ `TradeStrategy` åŸºç¡€ä¸Šæ‰©å±•ç­–ç•¥ä¸å‚æ•°ï¼ˆai_economy_behavior.py:32-38ï¼‰

### 6. è°ƒè¯•ä¸è§‚æµ‹API
- å¢åŠ APIï¼š
  - `/api/agents/<id>/decisions` è¿”å›`get_decision_statistics`ï¼ˆautonomous_decision.py:762-791ï¼‰
  - `/api/economy/stats` è¿”å› `get_economy_statistics`ï¼ˆai_economy_behavior.py:458-481ï¼‰
  - `/api/social/stats` è¿”å› `SocialNetwork.get_network_statistics`
  - `/api/terrain/stats` è¿”å› `get_development_statistics`ï¼ˆterrain_development.py:643-669ï¼‰
  - `/api/events/recent` è¿”å›äº‹ä»¶æ€»çº¿æœ€è¿‘é¡¹
- ç°æœ‰æ— é™åœ°å›¾APIä¿æŒä¸å˜ï¼Œæ–°å¢ä¸Šå±‚è·¯ç”±æ–‡ä»¶é›†ä¸­æš´éœ²

### 7. æ€§èƒ½ä¼˜åŒ–
- Tickåˆ†æ‰¹ï¼šæŒ‰å›ºå®šæ‰¹é‡è½®è¯¢Agentï¼Œå‡å°‘ç¬æ—¶è´Ÿè½½
- äº‹ä»¶é™æµä¸ç¼“å­˜ï¼šç“¦ç‰‡äº‹ä»¶ä¸Šé™ä¸æ·˜æ±°ç­–ç•¥ï¼Œå¤ç”¨`tile_cache`ï¼ˆinfinite_maze.py:159-166ï¼‰
- åœ°å›¾æ¸…ç†ï¼šç»§ç»­ä½¿ç”¨`cleanup_inactive_chunks`å¹¶è°ƒä¼˜è·ç¦»å‚æ•°ï¼ˆinfinite_maze.py:530-556ï¼‰
- è®¡ç®—åˆå¹¶ï¼šç»æµä¸ä»·æ ¼æ›´æ–°æ‰¹é‡åŒ–ï¼ˆgame.py:177-185å·²æœ‰å…¥å£ï¼‰

### 8. ç¨³å®šæ€§ä¸éªŒè¯
- æ­»é”/å¾ªç¯æ£€æµ‹ï¼šè®°å½•æ¯Agentæœ€è¿‘è¡ŒåŠ¨åºåˆ—çš„ç†µä¸é‡å¤ç‡ï¼Œé˜ˆå€¼é¢„è­¦
- åˆç†æ€§æ ¡éªŒï¼š
  - è¡Œä¸ºä¸ç›®æ ‡åŒ¹é…ç‡ï¼ˆå†³ç­–ç»Ÿè®¡ä¸­ä¼˜å…ˆçº§å‘½ä¸­æ•°ï¼‰
  - èµ„æºå®ˆæ’ä¸ä»·æ ¼æ³¢åŠ¨èŒƒå›´ï¼ˆeconomy.get_stateä¸`update_prices`ï¼‰
  - ç¤¾äº¤ç½‘ç»œå¼ºåº¦åˆ†å¸ƒä¸è¡°é€€é€Ÿç‡ï¼ˆsocial/relationship.py:198-212, 338-348ï¼‰
- é•¿è·‘æµ‹è¯•ï¼šè¿ç»­è¿è¡ŒNå¤©tickï¼Œè§‚å¯Ÿç¨³å®šç”Ÿæˆå¤šæ ·äº‹ä»¶ï¼Œæ—¥å¿—æ— å¼‚å¸¸å †ç§¯

## é‡Œç¨‹ç¢‘
- M1ï¼šå»ºé€ ä¸åœ°å›¾åŒæ­¥ + å°±è¿‘é€‰å€ï¼ˆå«äº‹ä»¶åˆ·æ–°ï¼‰
- M2ï¼šäº‹ä»¶æ€»çº¿ + è§‚æµ‹APIï¼ˆå†³ç­–/ç»æµ/ç¤¾äº¤/åœ°å½¢ï¼‰
- M3ï¼šç¤¾äº¤ç½‘ç»œé›†æˆåˆ°å†³ç­–åˆ†æ”¯ä¸å®šæœŸäº’åŠ¨
- M4ï¼šæ€§èƒ½ä¼˜åŒ–ï¼ˆæ‰¹é‡tickã€é™æµã€æ¸…ç†ï¼‰ä¸ç¨³å®šæ€§éªŒè¯å¥—ä»¶

## é£é™©ä¸åº”å¯¹
- åæ ‡æ˜ å°„ä¸ä¸€è‡´ï¼šé‡‡ç”¨ç®€å•1:1èµ·æ­¥ï¼Œåç»­æŒ‰`tile_size`ä¸chunkè¾¹ç•Œç²¾ç»†åŒ–
- äº‹ä»¶é‡è¿‡å¤§ï¼šè®¾ç½®æ¯ç“¦ç‰‡äº‹ä»¶ä¸Šé™ä¸æ€»çº¿ç¯å½¢ç¼“å†²
- LLMä¾èµ–ï¼šæ— LLMæ—¶ä¿æŒfailsafeä¸è§„åˆ™åˆ†æ”¯å¯è¿è¡Œï¼ˆagent.py:103-125, 841-849ï¼‰